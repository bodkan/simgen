
# Introduction to _tidyverse_

(A few remarks and tips before the practical session)

# Quick recap from our R bootcamp yesterday

#


<center>
We were not supposed to finish everything, so no stress.
<br><br>
<h3>
The motivation was to get familiar with the background of what makes a "data frame".
</h3>
</center>

## Vectors and lists

- Vectors are collections of values of the same type:

```{r}
sample   <- c("Loschbour", "UstIshim", "Saqqaq", "AltaiNeandertal")
coverage <- c(18.2,        35.2,       13.4,     44.8)
archaic  <- c(FALSE,       FALSE,      FALSE,    TRUE)
```

. . .

- Lists are collections of _anything_:

```{r}
list("Hello", TRUE, 123)
```

. . .

<center>**... and that "anything" can also include other vectors!**</center>

## An example of such a list of vectors...

<br>
<center>From vectors stored as individual variables...</center>
<br>

```{r}
sample   <- c("Loschbour", "UstIshim", "Saqqaq", "AltaiNeandertal")
coverage <- c(18.2,        35.2,       13.4,     44.8)
age      <- c(8050,        45020,      3885,     125000)
```

## An example of such a list of vectors...

<br>
<center>To those vectors stored as (named) list...</center>
<br>

```{r}
#| eval: false
list(
  sample   = c("Loschbour", "UstIshim", "Saqqaq", "AltaiNeandertal"),
  coverage = c(18.2,        35.2,       13.4,     44.8),
  age      = c(8050,        45020,      3885,     125000)
)
```


## Data frame is just that

<br>
<center>A list of vectors...</center>
<br>

```{r}
#| eval: false
list(
  sample   = c("Loschbour", "UstIshim", "Saqqaq", "AltaiNeandertal"),
  coverage = c(18.2,        35.2,       13.4,     44.8),
  age      = c(8050,        45020,      3885,     125000)
)
```

## Data frame is just that

<br>
<center>... which is just printed as a table.</center>
<br>

```{r}
#| output-location: fragment
data.frame(
  sample   = c("Loschbour", "UstIshim", "Saqqaq", "AltaiNeandertal"),
  coverage = c(18.2,        35.2,       13.4,     44.8),
  age      = c(8050,        45020,      3885,     125000)
)
```




```{r}
#| echo: false
df <- data.frame(
  sample   = c("Loschbour", "UstIshim", "Saqqaq", "AltaiNeandertal"),
  coverage = c(18.2,        35.2,       13.4,     44.8),
  age      = c(8050,        45020,      3885,     125000)
)
```




## Indexing into tables: `df[rows, cols]`

<br>
<u>Indexing by columns</u> (**"selecting columns"**)
<br>
<br>

```{r}
df[, c("sample", "coverage")]
```


## Indexing into tables: `df[rows, cols]`

<br>
<u>Indexing by rows</u> (**"filtering rows"**)
<br>

1. **using row numbers**:

```{r}
df[c(2, 3), ]
```

. . .

2. **using `TRUE`/`FALSE` for each row**:

:::: {.columns}

::: {.column}
```{r}
df[c(FALSE, TRUE, FALSE, TRUE), ]
```
:::


::: {.column}

::: {.fragment}
```{r}
df[df$coverage > 30, ] # same thing!
```
:::

:::

::::

## We can also extract columns with `$`

:::: {.columns}

::: {.column}
If `df` is our data frame:
:::

::: {.column}
```{r}
#| echo: false
df
```
:::

::::

. . .

- We can do this:

```{r}
#| output-location: column
df$age
```

. . .

- And also this:

```{r}
#| output-location: column
mean(df$age)
```

. . .

- Or maybe this, etc.:

```{r}
#| output-location: column
is.na(df$age)
```



#

<h1>The bootcamp was<br>"a trial by fire"</h1>

<br>
<p align="right">_tidyverse_ makes everything we had to do<br>the hard way infinitely easier.</p>

#

<center>![](files/tidy/tidyverse_heading.png){width="72%"}</center>

<br>
<center>
<h2>[tidyverse.org](https://tidyverse.org)</h2>
<small><br><br></small>
Nine "core" R packages and a "philosophy of data science design" which
inspired many many more specialized packages.
</center>


#

<center>

![](files/tidy/tidyverse_paper.png){width="60%"}

[link to the paper](https://joss.theoj.org/papers/10.21105/joss.01686)
</center>


## What is _tidyverse_?

<center>

![](files/tidy/workflow_diagram.png){width="70%"}

</center>

> <small>The _tidyverse_ is a language for solving data science challenges with R code.
Its primary goal is to facilitate a conversation between a human and a computer
about data. Less abstractly, the tidyverse is a collection of R packages that
share a high-level design philosophy [...] so that learning one package makes
it easier to learn the next.<br><br>
> The tidyverse encompasses the repeated tasks at the heart of every data
science project: data import, tidying, manipulation, visualisation, and programming.</small>


# This is still very abstract

#

<h2>In the spirit of hands-on interactivity, we will
leave "theory" and practice work hand-in-hand during exercises.</h2>

## Further companion study material

<center>

![](https://r4ds.hadley.nz/cover.jpg){width="40%"}

[https://r4ds.hadley.nz](https://r4ds.hadley.nz)
</center>

# Let's talk about our example data

# 

<center>

![](files/tidy/mesoneo_paper.png){width="40%"}

</center>

> <small>_"Western Eurasia witnessed several large-scale human migrations during the Holocene. Here, to investigate the cross-continental effects of these migrations, **we shotgun-sequenced 317 genomes—mainly from the Mesolithic and Neolithic periods—from across northern and western Eurasia**. These were **imputed alongside published data to obtain diploid genotypes from more than 1,600 ancient humans [and about 2,500 present-day humans]**."_</small>


#

<center>

![](files/tidy/mesoneo_samples.png)

</center>

. . .

**Our exercises will focus on two MesoNeo data sets:**

- Table of metadata information associated with each sample
- Genome-wide data set of Identity-by-Descent segments

## Why those two data sets?

- Table of metadata information associated with each sample
- Genome-wide data set of Identity-by-Descent segments

<hr>

1. Best representatives of modern population genetic data
2. Lots of opportunities to practice _tidyverse_ data processing
3. Even more opportunities to showcase _ggplot2_ possibilities

#

<center><h2>The main reason...</h2></center>

A great example of how to approach totally unfamiliar data!

. . .

<br>
<center><h1>True story.</h1></center>

<center>
<br>Recently, I was given this exact data set. I had to find
my way around it, and figure out how to build a project around it.
</center>

. . .

<center>
<br>**The exercises are retracing my own data exploration journey!**
</center>



# Let's get started!

1. Go to [www.bodkan.net/simgen](https://bodkan.net/simgen)
2. Click on _"Introduction to _tidyverse_"_ in the left panel
- This session will focus on the metadata
- The next session _"More _tidyverse_ practice"_ digs into IBD data
3. _"Cheatsheets and handouts"_ section in the left panel has
a single-page version of these slides and the _dplyr_ cheatsheet
4. Open your RStudio and start working!
